<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>æ—…è¡Œå…¬æ•¸ç³»çµ±</title>
<style>
  body { 
    font-family: Arial, sans-serif; 
    margin: 10px; 
    background: #f9f9f9;
  }
  h2 { 
    color: #333; 
    text-align: center;
    font-size: 1.6em;
    margin-bottom: 10px;
  }
  h3 {
    font-size: 1.2em;
    margin-top: 15px;
    color: #555;
  }
  input, button {
    padding: 10px; 
    margin: 5px 0;
    font-size: 1em;
    border-radius: 8px;
    border: 1px solid #ccc;
    width: 100%;
    box-sizing: border-box;
  }
  button {
    background-color: #4CAF50; 
    color: white; 
    border: none; 
    cursor: pointer;
    font-weight: bold;
  }
  button:hover {
    background-color: #45a049;
  }
  table { 
    border-collapse: collapse; 
    width: 100%; 
    margin-top: 10px; 
    background: white;
    border-radius: 8px;
    overflow: hidden;
  }
  th, td { 
    border: 1px solid #ddd; 
    padding: 8px; 
    text-align: center; 
    font-size: 0.95em;
  }
  th { 
    background-color: #f5f5f5; 
    font-weight: bold;
  }
  #balance { 
    font-size: 1.4em; 
    color: green; 
    margin: 15px 0; 
    text-align: center;
    font-weight: bold;
  }
  /* æ‰‹æ©Ÿé©é… */
  @media (max-width: 600px) {
    h2 { font-size: 1.4em; }
    input, button { font-size: 1em; }
    th, td { font-size: 0.85em; }
  }
</style>
</head>
<body>

<h2>ğŸ’° æ—…è¡Œå…¬æ•¸ç³»çµ±</h2>

<!-- æ–°å¢æ”¶å…¥ -->
<div>
  <h3>â• æ–°å¢æ”¶å…¥</h3>
  <input type="number" id="income" placeholder="ğŸ’µ é‡‘é¡">
  <button onclick="addIncome()">ğŸ’° æ–°å¢æ”¶å…¥</button>
</div>

<!-- é¡¯ç¤ºå‰©é¤˜é‡‘é¡ -->
<div id="balance">å‰©é¤˜é‡‘é¡ï¼š0 å…ƒ</div>

<hr>

<!-- æ–°å¢èŠ±è²» -->
<div>
  <h3>ğŸ’¸ æ–°å¢èŠ±è²»</h3>
  <input type="text" id="desc" placeholder="ğŸ“„ ç”¨é€”">
  <input type="number" id="amount" placeholder="ğŸ’µ é‡‘é¡">
  <button onclick="addExpense()">ğŸ’³ æ–°å¢èŠ±è²»</button>
</div>

<!-- ç´€éŒ„è¡¨ -->
<table>
  <thead>
    <tr>
      <th>ğŸ“‚ é¡å‹</th>
      <th>ğŸ’µ é‡‘é¡</th>
      <th>ğŸ“„ ç”¨é€”</th>
      <th>âš™ æ“ä½œ</th>
    </tr>
  </thead>
  <tbody id="recordsTable"></tbody>
</table>

<!-- Firebase -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
  import { getDatabase, ref, push, onValue, remove } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyChzgS_IFOevrenqUL0oecU9BS-GZg0QvE",
    authDomain: "osaka-3ed9a.firebaseapp.com",
    databaseURL: "https://osaka-3ed9a-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "osaka-3ed9a",
    storageBucket: "osaka-3ed9a.firebasestorage.app",
    messagingSenderId: "217169641602",
    appId: "1:217169641602:web:86253f954ba5506e8f749b"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  const recordsRef = ref(db, 'records');

  function renderRecords(records) {
    let totalBalance = 0;
    let html = '';
    records.forEach(r => {
      if (r.type === 'income') totalBalance += r.amount;
      else totalBalance -= r.amount;

      html += `<tr>
        <td>${r.type === 'income' ? 'ğŸ’° æ”¶å…¥' : 'ğŸ’¸ èŠ±è²»'}</td>
        <td>${r.amount}</td>
        <td>${r.desc}</td>
        <td><button style="background:#e74c3c" onclick="deleteRecord('${r.id}')">ğŸ—‘ åˆªé™¤</button></td>
      </tr>`;
    });
    document.getElementById('recordsTable').innerHTML = html;
    document.getElementById('balance').innerText = `ğŸ’µ å‰©é¤˜é‡‘é¡ï¼š${totalBalance.toFixed(2)} å…ƒ`;
  }

  // å³æ™‚ç›£è½è³‡æ–™è®ŠåŒ–
  onValue(recordsRef, snapshot => {
    const data = snapshot.val() || {};
    const records = Object.keys(data).map(id => ({
      id,
      ...data[id]
    }));
    renderRecords(records);
  });

  window.addIncome = function() {
    let amount = parseFloat(document.getElementById('income').value);
    if (isNaN(amount) || amount <= 0) {
      alert('é‡‘é¡éœ€å¤§æ–¼ 0');
      return;
    }
    push(recordsRef, { type: 'income', amount, desc: 'å…¬å¸³æ”¶å…¥' });
    document.getElementById('income').value = '';
  };

  window.addExpense = function() {
    let amount = parseFloat(document.getElementById('amount').value);
    let desc = document.getElementById('desc').value.trim();
    if (!desc) {
      alert('è«‹è¼¸å…¥ç”¨é€”');
      return;
    }
    if (isNaN(amount) || amount <= 0) {
      alert('é‡‘é¡éœ€å¤§æ–¼ 0');
      return;
    }
    push(recordsRef, { type: 'expense', amount, desc });
    document.getElementById('amount').value = '';
    document.getElementById('desc').value = '';
  };

  window.deleteRecord = function(id) {
    if (!confirm('ç¢ºå®šè¦åˆªé™¤æ­¤ç´€éŒ„å—ï¼Ÿ')) return;
    remove(ref(db, 'records/' + id));
  };
</script>

</body>
</html>





