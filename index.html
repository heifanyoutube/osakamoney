<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>ğŸ’° æ—…è¡Œå…¬æ•¸ç³»çµ± - Firebase ç‰ˆ</title>
<style>
  :root {
    --primary-color: #4CAF50;
    --primary-hover: #45a049;
    --danger-color: #e74c3c;
    --bg-light: #f9f9f9;
    --border-color: #ccc;
    --table-border: #ddd;
  }
  body {
    font-family: Arial, sans-serif;
    margin: 5px;
    padding: 0 5px;
    background: var(--bg-light);
    width: 100%;
  }
  h2, h3 { text-align: center; margin: 8px 0; }
  h2 { font-size: 1.4em; color: #333; }
  h3 { font-size: 1.1em; color: #555; }

  input, button {
    padding: 10px;
    margin: 4px 0;
    font-size: 1em;
    border-radius: 6px;
    border: 1px solid var(--border-color);
    width: 100%;
    box-sizing: border-box;
  }
  button {
    background-color: var(--primary-color);
    color: white;
    border: none;
    cursor: pointer;
    font-weight: bold;
    min-height: 44px;
  }
  button:hover { background-color: var(--primary-hover); }
  .btn-danger { background: var(--danger-color); }

  #balance {
    font-size: 1.2em;
    color: green;
    margin: 10px 0;
    text-align: center;
    font-weight: bold;
  }

  .table-container {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    border-radius: 6px;
  }
  table {
    border-collapse: collapse;
    width: 100%;
    background: white;
    min-width: 450px;
  }
  th, td {
    border: 1px solid var(--table-border);
    padding: 8px;
    text-align: center;
    font-size: 0.9em;
  }
  th { background-color: #f5f5f5; }

  @media (max-width: 400px) {
    h2 { font-size: 1.2em; }
    h3 { font-size: 1em; }
    input, button { font-size: 0.95em; padding: 8px; }
    th, td { font-size: 0.85em; padding: 6px; }
  }
</style>
</head>
<body>

<h2>ğŸ’° æ—…è¡Œå…¬æ•¸ç³»çµ±</h2>

<section>
  <h3>â• æ–°å¢æ”¶å…¥</h3>
  <input type="number" id="income" placeholder="ğŸ’µ é‡‘é¡">
  <button id="addIncomeBtn">ğŸ’° æ–°å¢æ”¶å…¥</button>
</section>

<div id="balance">å‰©é¤˜é‡‘é¡ï¼š0 å…ƒ</div>
<hr>

<section>
  <h3>ğŸ’¸ æ–°å¢èŠ±è²»</h3>
  <input type="text" id="desc" placeholder="ğŸ“„ ç”¨é€”">
  <input type="number" id="amount" placeholder="ğŸ’µ é‡‘é¡">
  <button id="addExpenseBtn">ğŸ’³ æ–°å¢èŠ±è²»</button>
</section>

<div class="table-container">
  <table>
    <thead>
      <tr>
        <th>ğŸ“‚ é¡å‹</th>
        <th>ğŸ’µ é‡‘é¡</th>
        <th>ğŸ“„ ç”¨é€”</th>
        <th>âš™ æ“ä½œ</th>
      </tr>
    </thead>
    <tbody id="recordsTable"></tbody>
  </table>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
  import { getDatabase, ref, push, onValue, remove } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyChzgS_IFOevrenqUL0oecU9BS-GZg0QvE",
    authDomain: "osaka-3ed9a.firebaseapp.com",
    databaseURL: "https://osaka-3ed9a-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "osaka-3ed9a",
    storageBucket: "osaka-3ed9a.firebasestorage.app",
    messagingSenderId: "217169641602",
    appId: "1:217169641602:web:86253f954ba5506e8f749b"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
  const recordsRef = ref(db, 'records');

  const incomeInput = document.getElementById('income');
  const expenseAmountInput = document.getElementById('amount');
  const expenseDescInput = document.getElementById('desc');
  const recordsTable = document.getElementById('recordsTable');
  const balanceEl = document.getElementById('balance');

  const renderRecords = (records) => {
    let totalBalance = 0;
    const rows = records.map(r => {
      totalBalance += r.type === 'income' ? r.amount : -r.amount;
      return `
        <tr>
          <td>${r.type === 'income' ? 'ğŸ’° æ”¶å…¥' : 'ğŸ’¸ èŠ±è²»'}</td>
          <td>${r.amount}</td>
          <td>${r.desc}</td>
          <td><button class="btn-danger" onclick="deleteRecord('${r.id}')">ğŸ—‘ åˆªé™¤</button></td>
        </tr>`;
    }).join('');
    recordsTable.innerHTML = rows;
    balanceEl.textContent = `ğŸ’µ å‰©é¤˜é‡‘é¡ï¼š${totalBalance.toFixed(2)} å…ƒ`;
  };

  onValue(recordsRef, snapshot => {
    const data = snapshot.val() || {};
    const records = Object.keys(data).map(id => ({ id, ...data[id] }));
    renderRecords(records);
  });

  const addRecord = (type, amount, desc) => {
    push(recordsRef, { type, amount, desc });
  };

  document.getElementById('addIncomeBtn').addEventListener('click', () => {
    const amount = parseFloat(incomeInput.value);
    if (isNaN(amount) || amount <= 0) return alert('é‡‘é¡éœ€å¤§æ–¼ 0');
    addRecord('income', amount, 'å…¬å¸³æ”¶å…¥');
    incomeInput.value = '';
  });

  document.getElementById('addExpenseBtn').addEventListener('click', () => {
    const amount = parseFloat(expenseAmountInput.value);
    const desc = expenseDescInput.value.trim();
    if (!desc) return alert('è«‹è¼¸å…¥ç”¨é€”');
    if (isNaN(amount) || amount <= 0) return alert('é‡‘é¡éœ€å¤§æ–¼ 0');
    addRecord('expense', amount, desc);
    expenseAmountInput.value = '';
    expenseDescInput.value = '';
  });

  window.deleteRecord = (id) => {
    if (confirm('ç¢ºå®šè¦åˆªé™¤æ­¤ç´€éŒ„å—ï¼Ÿ')) {
      remove(ref(db, 'records/' + id));
    }
  };
</script>

</body>
</html>







